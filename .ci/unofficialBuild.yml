# https://aka.ms/yaml
parameters:
- name: publishManagementPackage
  type: boolean
  default: true
- name: publishVmfsPackage
  type: boolean
  default: false

trigger:
- none

pr:
  branches:
    include:
    - main
  drafts: false
  autoCancel: false
######################################

variables:
- template: vars.yml

name: $(Rev:r) # Provide build run number (i.e., Build.BuildNumber) that is used as patch for build version and ultimately module version
######################################

stages:
- ${{ if eq(parameters['publishManagementPackage'], true ) }}:
  - template: templates/common-unofficialBuild-stages.yml@self
    parameters:
      moduleFolderName: ${{ variables.managementModuleFolderName }}
      moduleDisplayName: ${{ variables.managementModuleDisplayName }}

- ${{ if eq(parameters['publishVmfsPackage'], true ) }}:
  - template: templates/common-unofficialBuild-stages.yml@self
    parameters:
      moduleFolderName: ${{ variables.vmfsModuleFolderName }}
      moduleDisplayName: ${{ variables.vmfsModuleDisplayName }}
